{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<!-- CSS -->
	<link rel="stylesheet" href="{% static 'css/bootstrap-reboot.min.css' %}">
	<link rel="stylesheet" href="{% static 'css/bootstrap-grid.min.css' %}">
	<link rel="stylesheet" href="{% static 'css/owl.carousel.min.css' %}">
	<link rel="stylesheet" href="{% static 'css/slider-radio.css' %}">
	<link rel="stylesheet" href="{% static 'css/select2.min.css' %}">
	<link rel="stylesheet" href="{% static 'css/magnific-popup.css' %}">
	<link rel="stylesheet" href="{% static 'css/plyr.css' %}">
	<link rel="stylesheet" href="{% static 'css/main.css' %}">

	<!-- Favicons -->
	<link rel="icon" type="image/png" href="{% static 'icon/favicon-32x32.png' %}" sizes="32x32">
	<link rel="apple-touch-icon" href="{% static 'icon/favicon-32x32.png' %}">

	<meta name="description" content="CineGenie - Movie Recommendation Platform">
	<meta name="keywords" content="movies, recommendations, cinema, watch, online">
	<meta name="author" content="CineGenie">
	<title>CineGenie - Movie Recommendation Platform</title>

	<!-- Add custom CSS for placeholder images -->
	<style>
		.placeholder-poster {
			background-color: #1a1a1a;
			display: flex;
			align-items: center;
			justify-content: center;
			color: #666;
			text-align: center;
			height: 100%;
			width: 100%;
			font-size: 14px;
			padding: 15px;
		}
		.home__card .placeholder-poster {
			aspect-ratio: 2/3;
			min-height: 250px;
		}
		.card__cover .placeholder-poster {
			aspect-ratio: 2/3;
			min-height: 250px;
		}
	</style>

</head>
<body>
	<!-- header -->
	<header class="header header--static">
		<div class="container">
			<div class="row">
				<div class="col-12">
					<div class="header__content">

						<a href="{% url 'index' %}" class="header__logo">
							<img src="{% static 'img/logo.png' %}" alt="CineGenie">
						</a>

						<ul class="header__nav">
							<li class="header__nav-item">
								<a class="header__nav-link" href="#" role="button" id="dropdownMenu0" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Home <svg width="4" height="4" viewBox="0 0 4 4" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.93893 3.30334C1.08141 3.30334 0.384766 2.60669 0.384766 1.75047C0.384766 0.894254 1.08141 0.196308 1.93893 0.196308C2.79644 0.196308 3.49309 0.894254 3.49309 1.75047C3.49309 2.60669 2.79644 3.30334 1.93893 3.30334Z"/></svg></a>

								<ul class="dropdown-menu header__nav-menu" aria-labelledby="dropdownMenu0">
									<li><a href="{% url 'index' %}">Home</a></li>
									<li><a href="{% url 'tmdb_test' %}">TMDb Test Page</a></li>
								</ul>
							</li>
							<li class="header__nav-item">
								<a class="header__nav-link" href="#" role="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Catalog <svg width="4" height="4" viewBox="0 0 4 4" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.93893 3.30334C1.08141 3.30334 0.384766 2.60669 0.384766 1.75047C0.384766 0.894254 1.08141 0.196308 1.93893 0.196308C2.79644 0.196308 3.49309 0.894254 3.49309 1.75047C3.49309 2.60669 2.79644 3.30334 1.93893 3.30334Z"/></svg></a>

								<ul class="dropdown-menu header__nav-menu" aria-labelledby="dropdownMenu1">
									<li><a href="#">Catalog</a></li>
									<li><a href="#">Movies</a></li>
									<li><a href="#">TV Series</a></li>
									<li><a href="#">Cartoons</a></li>
								</ul>
							</li>
						</ul>

						<div class="header__actions">
							<form action="/search/" class="header__form">
								<input class="header__form-input" type="text" name="query" placeholder="Search for movies..." id="movie-search-input">
								<div class="search-results-dropdown" style="display: none; position: absolute; width: 100%; max-height: 70vh; overflow-y: auto; background-color: #222028; z-index: 1000; border-radius: 4px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3); margin-top: 2px; left: 0; right: 0; top: 100%;">
									<ul class="search-results-list" style="list-style: none; padding: 0; margin: 0;"></ul>
								</div>
								<button class="header__form-btn" type="submit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21.71,20.29,18,16.61A9,9,0,1,0,16.61,18l3.68,3.68a1,1,0,0,0,1.42,0A1,1,0,0,0,21.71,20.29ZM11,18a7,7,0,1,1,7-7A7,7,0,0,1,11,18Z"/></svg></button>
								<button type="button" class="header__form-close"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M14.3345 0.000183105H5.66549C2.26791 0.000183105 0.000488281 2.43278 0.000488281 5.91618V14.0842C0.000488281 17.5709 2.26186 20.0002 5.66549 20.0002H14.3335C17.7381 20.0002 20.0005 17.5709 20.0005 14.0842V5.91618C20.0005 2.42969 17.7383 0.000183105 14.3345 0.000183105ZM5.66549 1.50018H14.3345C16.885 1.50018 18.5005 3.23515 18.5005 5.91618V14.0842C18.5005 16.7653 16.8849 18.5002 14.3335 18.5002H5.66549C3.11525 18.5002 1.50049 16.7655 1.50049 14.0842V5.91618C1.50049 3.23856 3.12083 1.50018 5.66549 1.50018ZM7.07071 7.0624C7.33701 6.79616 7.75367 6.772 8.04726 6.98988L8.13137 7.06251L9.99909 8.93062L11.8652 7.06455C12.1581 6.77166 12.6329 6.77166 12.9258 7.06455C13.1921 7.33082 13.2163 7.74748 12.9984 8.04109L12.9258 8.12521L11.0596 9.99139L12.9274 11.8595C13.2202 12.1524 13.2202 12.6273 12.9273 12.9202C12.8309 13.0166 12.7162 13.0846 12.5932 13.1221C12.4702 13.1597 12.3411 13.1660 12.2154 13.1405C12.0897 13.115 11.9713 13.0585 11.8689 12.9748C11.7665 12.8911 11.6825 12.7822 11.6236 12.658L11.5843 12.5531L9.99898 10.9672L8.13382 12.8562C8.03737 12.9527 7.92269 13.0206 7.79969 13.0582C7.67669 13.0958 7.54758 13.1021 7.42187 13.0766C7.29616 13.051 7.17779 12.9946 7.07537 12.9108C6.97295 12.8271 6.88905 12.7182 6.83016 12.594L6.79092 12.4892C6.73183 12.2902 6.76166 12.0739 6.8739 11.8962L6.93355 11.8127L8.79923 9.99128L6.93251 8.12475C6.63963 7.83186 6.63963 7.35701 6.93251 7.06412L7.07071 7.0624Z"/></svg></button>
							</form>

							<button class="header__search" type="button">
								<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21.71,20.29,18,16.61A9,9,0,1,0,16.61,18l3.68,3.68a1,1,0,0,0,1.42,0A1,1,0,0,0,21.71,20.29ZM11,18a7,7,0,1,1,7-7A7,7,0,0,1,11,18Z"/></svg>
							</button>

							{% if user.is_authenticated %}
							<div class="dropdown header__user">
								<a class="dropdown-toggle header__user-btn" href="#" role="button" id="dropdownMenuClick" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
									<span>{{ user.username }}</span>
									<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,2A10,10,0,0,0,2,12a9.89,9.89,0,0,0,2.26,6.33l-2,2a1,1,0,0,0-.21,1.09A1,1,0,0,0,3,22h9A10,10,0,0,0,12,2Zm0,18H5.41l.93-.93a1,1,0,0,0,.3-.71,1,1,0,0,0-.3-.7A8,8,0,1,1,12,20Z"></path></svg>
								</a>

								<div class="dropdown-menu header__user-menu" aria-labelledby="dropdownMenuClick">
									<a href="{% url 'aibot' %}" class="header__user-menu-item">
										<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,2C6.48,2,2,6.48,2,12s4.48,10,10,10s10-4.48,10-10S17.52,2,12,2z M12,16c-2.21,0-4-1.79-4-4 c0-2.21,1.79-4,4-4c2.21,0,4,1.79,4,4C16,14.21,14.21,16,12,16z M18.58,7.58C18.1,7.31,17.55,7.13,17,7.03V6h-2v1.03 C14.45,7.13,13.9,7.31,13.41,7.58L12,6.17l-1.41,1.41l1.41,1.41C11.73,9.69,11.55,10.45,11.55,11.25c0,0.8,0.18,1.56,0.47,2.25L10.61,14.91l1.41,1.41 l1.41-1.41C14.1,15.59,14.86,15.77,15.66,15.77c0.8,0,1.56-0.18,2.25-0.47l1.41,1.41l1.41-1.41l-1.41-1.41 C19.59,13.1,19.77,12.34,19.77,11.55C19.77,10.75,19.59,9.99,19.3,9.3z"/></svg> <span>AI Chat</span>
									</a>
									<a href="{% url 'logout' %}" class="header__user-menu-item">
										<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.5,15.1a1,1,0,0,0-1.34.45A8,8,0,1,1,12,4a7.93,7.93,0,0,1,7.16,4.45,1,1,0,0,0,1.8-.9,10,10,0,1,0,0,8.9A1,1,0,0,0,20.5,15.1ZM21,11H11.41l2.3-2.29a1,1,0,1,0-1.42-1.42l-4,4a1,1,0,0,0-.21.33,1,1,0,0,0,0,.76,1,1,0,0,0,.21.33l4,4a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42L11.41,13H21a1,1,0,0,0,0-2Z"></path></svg> <span>Sign Out</span>
									</a>
								</div>
							</div>
							{% else %}
							<a href="{% url 'login' %}" class="header__user">
								<span>Sign in</span>
								<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,12a1,1,0,0,0-1-1H11.41l2.3-2.29a1,1,0,1,0-1.42-1.42l-4,4a1,1,0,0,0-.21.33,1,1,0,0,0,0,.76,1,1,0,0,0,.21.33l4,4a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42L11.41,13H19A1,1,0,0,0,20,12Z"/></svg>
							</a>
							{% endif %}
						</div>
					</div>
				</div>
			</div>
		</div>
	</header>
	<!-- end header -->

	<!-- home -->
	<div class="home home--title">
		<div class="container">
			<div class="row">
				<div class="col-12">
					<h1 class="home__title"><b>Best Movies</b> of this season</h1>
				</div>
			</div>
		</div>

		<div class="home__carousel owl-carousel" id="flixtv-hero">
			{% for movie in popular_movies %}
			<div class="home__card">
				<a href="{% url 'movie_details' %}?id={{ movie.id }}">
					{% if movie.poster_path %}
					<img src="{{ movie.poster_path }}" alt="{{ movie.title }}">
					{% else %}
					<div class="placeholder-poster">
						<div>
							<div>No Image Available</div>
							<div style="margin-top: 10px;">{{ movie.title }}</div>
						</div>
					</div>
					{% endif %}
				</a>
				<div>
					<h2>{{ movie.title }}</h2>
					<ul>
						<li>Free</li>
						{% if movie.genres %}
						<li>{{ movie.genres.0 }}</li>
						{% endif %}
						{% if movie.release_year %}
						<li>{{ movie.release_year }}</li>
						{% endif %}
					</ul>
				</div>
				<button class="home__add" type="button" data-movie-id="{{ movie.id }}" data-movie-title="{{ movie.title }}"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg></button>
				<span class="home__rating"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22,9.67A1,1,0,0,0,21.14,9l-5.69-.83L12.9,3a1,1,0,0,0-1.8,0L8.55,8.16,2.86,9a1,1,0,0,0-.81.68,1,1,0,0,0,.25,1l4.13,4-1,5.68A1,1,0,0,0,6.9,21.44L12,18.77l5.1,2.67a.93.93,0,0,0,.46.12,1,1,0,0,0,.59-.19,1,1,0,0,0,.4-1l-1-5.68,4.13-4A1,1,0,0,0,22,9.67Zm-6.15,4a1,1,0,0,0-.29.88l.72,4.2-3.76-2a1.06,1.06,0,0,0-.94,0l-3.76,2,.72-4.2a1,1,0,0,0-.29-.88l-3-3,4.21-.61a1,1,0,0,0,.76-.55L12,5.7l1.88,3.82a1,1,0,0,0,.76.55l4.21.61Z"/></svg> {{ movie.vote_average }}</span>
			</div>
			{% endfor %}
		</div>

		<button class="home__nav home__nav--prev" data-nav="#flixtv-hero" type="button"></button>
		<button class="home__nav home__nav--next" data-nav="#flixtv-hero" type="button"></button>
	</div>
	<!-- end home -->

	<!-- popular -->
	{% comment %} <section class="section">
		<div class="container">
			<div class="row">
				<div class="col-12">
					<h2 class="section__title"><a href="category.html">Popular</a></h2>
				</div>

				<div class="col-12">
					<div class="section__carousel-wrap">
						<div class="section__carousel owl-carousel" id="popular">
							{% for movie in popular_movies %}
							<div class="card">
								<a href="{% url 'movie_details' %}?id={{ movie.id }}" class="card__cover">
									{% if movie.poster_path %}
									<img src="{{ movie.poster_path }}" alt="{{ movie.title }}">
									{% else %}
									<div class="placeholder-poster">
										<div>
											<div>No Image Available</div>
											<div style="margin-top: 10px;">{{ movie.title }}</div>
										</div>
									</div>
									{% endif %}
								</a>
								<button class="card__add" type="button" data-movie-id="{{ movie.id }}" data-movie-title="{{ movie.title }}"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"/></svg></button>
								<span class="card__rating"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22,9.67A1,1,0,0,0,21.14,9l-5.69-.83L12.9,3a1,1,0,0,0-1.8,0L8.55,8.16,2.86,9a1,1,0,0,0-.81.68,1,1,0,0,0,.25,1l4.13,4-1,5.68A1,1,0,0,0,6.9,21.44L12,18.77l5.1,2.67a.93.93,0,0,0,.46.12,1,1,0,0,0,.59-.19,1,1,0,0,0,.4-1l-1-5.68,4.13-4A1,1,0,0,0,22,9.67Zm-6.15,4a1,1,0,0,0-.29.88l.72,4.2-3.76-2a1.06,1.06,0,0,0-.94,0l-3.76,2,.72-4.2a1,1,0,0,0-.29-.88l-3-3,4.21-.61a1,1,0,0,0,.76-.55L12,5.7l1.88,3.82a1,1,0,0,0,.76.55l4.21.61Z"/></svg> {{ movie.vote_average }}</span>
								<h3 class="card__title"><a href="{% url 'movie_details' %}?id={{ movie.id }}">{{ movie.title }}</a></h3>
								<ul class="card__list">
									<li>Free</li>
									{% if movie.genres %}
									<li>{{ movie.genres.0 }}</li>
									{% endif %}
									{% if movie.release_year %}
									<li>{{ movie.release_year }}</li>
									{% endif %}
								</ul>
							</div>
							{% endfor %}
						</div>

						<button class="section__nav section__nav--cards section__nav--prev" data-nav="#popular" type="button"><svg width="17" height="15" viewBox="0 0 17 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.25 7.72559L16.25 7.72559" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M7.2998 1.70124L1.2498 7.72524L7.2998 13.7502" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></button>
						<button class="section__nav section__nav--cards section__nav--next" data-nav="#popular" type="button"><svg width="17" height="15" viewBox="0 0 17 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.75 7.72559L0.75 7.72559" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M9.7002 1.70124L15.7502 7.72524L9.7002 13.7502" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></button>
					</div>
				</div>
			</div>
		</div>
	</section> {% endcomment %}
	<!-- end popular -->

		<!-- top_rated -->
	 	<section class="section">
		<div class="container">
			<div class="row">
				<div class="col-12">
					<h2 class="section__title"><a href="category.html">Top Rated</a></h2>
				</div>

				<div class="col-12">
					<div class="section__carousel-wrap">
						<div class="section__carousel owl-carousel" id="popular">
							{% for movie in top_rated_movies %}
							<div class="card">
								<a href="{% url 'movie_details' %}?id={{ movie.id }}" class="card__cover">
									{% if movie.poster_path %}
									<img src="{{ movie.poster_path }}" alt="{{ movie.title }}">
									{% else %}
									<div class="placeholder-poster">
										<div>
											<div>No Image Available</div>
											<div style="margin-top: 10px;">{{ movie.title }}</div>
										</div>
									</div>
									{% endif %}
								</a>
								<button class="card__add" type="button" data-movie-id="{{ movie.id }}" data-movie-title="{{ movie.title }}"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"/></svg></button>
								<span class="card__rating"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22,9.67A1,1,0,0,0,21.14,9l-5.69-.83L12.9,3a1,1,0,0,0-1.8,0L8.55,8.16,2.86,9a1,1,0,0,0-.81.68,1,1,0,0,0,.25,1l4.13,4-1,5.68A1,1,0,0,0,6.9,21.44L12,18.77l5.1,2.67a.93.93,0,0,0,.46.12,1,1,0,0,0,.59-.19,1,1,0,0,0,.4-1l-1-5.68,4.13-4A1,1,0,0,0,22,9.67Zm-6.15,4a1,1,0,0,0-.29.88l.72,4.2-3.76-2a1.06,1.06,0,0,0-.94,0l-3.76,2,.72-4.2a1,1,0,0,0-.29-.88l-3-3,4.21-.61a1,1,0,0,0,.76-.55L12,5.7l1.88,3.82a1,1,0,0,0,.76.55l4.21.61Z"/></svg> {{ movie.vote_average }}</span>
								<h3 class="card__title"><a href="{% url 'movie_details' %}?id={{ movie.id }}">{{ movie.title }}</a></h3>
								<ul class="card__list">
									<li>Free</li>
									{% if movie.genres %}
									<li>{{ movie.genres.0 }}</li>
									{% endif %}
									{% if movie.release_year %}
									<li>{{ movie.release_year }}</li>
									{% endif %}
								</ul>
							</div>
							{% endfor %}
						</div>

						<button class="section__nav section__nav--cards section__nav--prev" data-nav="#popular" type="button"><svg width="17" height="15" viewBox="0 0 17 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.25 7.72559L16.25 7.72559" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M7.2998 1.70124L1.2498 7.72524L7.2998 13.7502" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></button>
						<button class="section__nav section__nav--cards section__nav--next" data-nav="#popular" type="button"><svg width="17" height="15" viewBox="0 0 17 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.75 7.72559L0.75 7.72559" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M9.7002 1.70124L15.7502 7.72524L9.7002 13.7502" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></button>
					</div>
				</div>
			</div>
		</div>
	</section>
	<!-- end top_rated -->

	<!-- trending -->
	 	<section class="section">
		<div class="container">
			<div class="row">
				<div class="col-12">
					<h2 class="section__title"><a href="category.html">Trending Movies</a></h2>
				</div>

				<div class="col-12">
					<div class="section__carousel-wrap">
						<div class="section__carousel owl-carousel" id="popular">
							{% for movie in trending_movies %}
							<div class="card">
								<a href="{% url 'movie_details' %}?id={{ movie.id }}" class="card__cover">
									{% if movie.poster_path %}
									<img src="{{ movie.poster_path }}" alt="{{ movie.title }}">
									{% else %}
									<div class="placeholder-poster">
										<div>
											<div>No Image Available</div>
											<div style="margin-top: 10px;">{{ movie.title }}</div>
										</div>
									</div>
									{% endif %}
								</a>
								<button class="card__add" type="button" data-movie-id="{{ movie.id }}" data-movie-title="{{ movie.title }}"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"/></svg></button>
								<span class="card__rating"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22,9.67A1,1,0,0,0,21.14,9l-5.69-.83L12.9,3a1,1,0,0,0-1.8,0L8.55,8.16,2.86,9a1,1,0,0,0-.81.68,1,1,0,0,0,.25,1l4.13,4-1,5.68A1,1,0,0,0,6.9,21.44L12,18.77l5.1,2.67a.93.93,0,0,0,.46.12,1,1,0,0,0,.59-.19,1,1,0,0,0,.4-1l-1-5.68,4.13-4A1,1,0,0,0,22,9.67Zm-6.15,4a1,1,0,0,0-.29.88l.72,4.2-3.76-2a1.06,1.06,0,0,0-.94,0l-3.76,2,.72-4.2a1,1,0,0,0-.29-.88l-3-3,4.21-.61a1,1,0,0,0,.76-.55L12,5.7l1.88,3.82a1,1,0,0,0,.76.55l4.21.61Z"/></svg> {{ movie.vote_average }}</span>
								<h3 class="card__title"><a href="{% url 'movie_details' %}?id={{ movie.id }}">{{ movie.title }}</a></h3>
								<ul class="card__list">
									<li>Free</li>
									{% if movie.genres %}
									<li>{{ movie.genres.0 }}</li>
									{% endif %}
									{% if movie.release_year %}
									<li>{{ movie.release_year }}</li>
									{% endif %}
								</ul>
							</div>
							{% endfor %}
						</div>

						<button class="section__nav section__nav--cards section__nav--prev" data-nav="#popular" type="button"><svg width="17" height="15" viewBox="0 0 17 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.25 7.72559L16.25 7.72559" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M7.2998 1.70124L1.2498 7.72524L7.2998 13.7502" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></button>
						<button class="section__nav section__nav--cards section__nav--next" data-nav="#popular" type="button"><svg width="17" height="15" viewBox="0 0 17 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.75 7.72559L0.75 7.72559" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M9.7002 1.70124L15.7502 7.72524L9.7002 13.7502" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></button>
					</div>
				</div>
			</div>
		</div>
	</section>
	<!-- end trending -->

	<!-- popular tv shows -->
	 	<section class="section">
		<div class="container">
			<div class="row">
				<div class="col-12">
					<h2 class="section__title"><a href="category.html">Popular TV Shows</a></h2>
				</div>

				<div class="col-12">
					<div class="section__carousel-wrap">
						<div class="section__carousel owl-carousel" id="popular">
							{% for movie in popular_tv_shows %}
							<div class="card">
								<a href="{% url 'movie_details' %}?id={{ movie.id }}" class="card__cover">
									{% if movie.poster_path %}
									<img src="{{ movie.poster_path }}" alt="{{ movie.title }}">
									{% else %}
									<div class="placeholder-poster">
										<div>
											<div>No Image Available</div>
											<div style="margin-top: 10px;">{{ movie.title }}</div>
										</div>
									</div>
									{% endif %}
								</a>
								<button class="card__add" type="button" data-movie-id="{{ movie.id }}" data-movie-title="{{ movie.title }}"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"/></svg></button>
								<span class="card__rating"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22,9.67A1,1,0,0,0,21.14,9l-5.69-.83L12.9,3a1,1,0,0,0-1.8,0L8.55,8.16,2.86,9a1,1,0,0,0-.81.68,1,1,0,0,0,.25,1l4.13,4-1,5.68A1,1,0,0,0,6.9,21.44L12,18.77l5.1,2.67a.93.93,0,0,0,.46.12,1,1,0,0,0,.59-.19,1,1,0,0,0,.4-1l-1-5.68,4.13-4A1,1,0,0,0,22,9.67Zm-6.15,4a1,1,0,0,0-.29.88l.72,4.2-3.76-2a1.06,1.06,0,0,0-.94,0l-3.76,2,.72-4.2a1,1,0,0,0-.29-.88l-3-3,4.21-.61a1,1,0,0,0,.76-.55L12,5.7l1.88,3.82a1,1,0,0,0,.76.55l4.21.61Z"/></svg> {{ movie.vote_average }}</span>
								<h3 class="card__title"><a href="{% url 'movie_details' %}?id={{ movie.id }}">{{ movie.title }}</a></h3>
								<ul class="card__list">
									<li>Free</li>
									{% if movie.genres %}
									<li>{{ movie.genres.0 }}</li>
									{% endif %}
									{% if movie.release_year %}
									<li>{{ movie.release_year }}</li>
									{% endif %}
								</ul>
							</div>
							{% endfor %}
						</div>

						<button class="section__nav section__nav--cards section__nav--prev" data-nav="#popular" type="button"><svg width="17" height="15" viewBox="0 0 17 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.25 7.72559L16.25 7.72559" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M7.2998 1.70124L1.2498 7.72524L7.2998 13.7502" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></button>
						<button class="section__nav section__nav--cards section__nav--next" data-nav="#popular" type="button"><svg width="17" height="15" viewBox="0 0 17 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.75 7.72559L0.75 7.72559" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M9.7002 1.70124L15.7502 7.72524L9.7002 13.7502" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></button>
					</div>
				</div>
			</div>
		</div>
	</section>
	<!-- end popular tv shows -->

	<!-- footer -->
	<footer class="footer">
		<div class="container">
			<div class="row">
				<div class="col-12">
					<div class="footer__content">
						<a href="{% url 'index' %}" class="footer__logo">
							<img src="{% static 'img/logo.png' %}" alt="">
						</a>

						<span class="footer__copyright">© CineGenie, 2025</span>

						<nav class="footer__nav">
							<a href="{% url 'privacy' %}">Privacy policy</a>
							<a href="{% url 'login' %}">Sign in</a>
							<a href="{% url 'signup' %}">Sign up</a>
						</nav>

						<button class="footer__back" type="button">
							<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.1714 12.0007L8.22168 7.05093L9.63589 5.63672L15.9999 12.0007L9.63589 18.3646L8.22168 16.9504L13.1714 12.0007Z"/></svg>
						</button>
					</div>
				</div>
			</div>
		</div>
	</footer>
	<!-- end footer -->

	<!-- JS -->
	<script src="{% static 'js/jquery-3.5.1.min.js' %}"></script>
	<script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>
	<script src="{% static 'js/owl.carousel.min.js' %}"></script>
	<script src="{% static 'js/slider-radio.js' %}"></script>
	<script src="{% static 'js/select2.min.js' %}"></script>
	<script src="{% static 'js/smooth-scrollbar.js' %}"></script>
	<script src="{% static 'js/jquery.magnific-popup.min.js' %}"></script>
	<script src="{% static 'js/plyr.min.js' %}"></script>
	<script src="{% static 'js/main.js' %}"></script>

	<!-- Add to Favorites functionality -->
	<script>
		$(document).ready(function() {
			// Initialize favorites from localStorage
			let favorites = JSON.parse(localStorage.getItem('movieFavorites')) || [];
			
			// Update UI to show which movies are already favorites
			updateFavoritesUI();
			
			// Add click handler for favorite buttons
			$('.home__add, .card__add').on('click', function() {
				const movieId = $(this).data('movie-id');
				const movieTitle = $(this).data('movie-title');
				
				// Check if movie is already in favorites
				const index = favorites.findIndex(m => m.id === movieId);
				
				if (index === -1) {
					// Add to favorites
					favorites.push({
						id: movieId,
						title: movieTitle,
						dateAdded: new Date().toISOString()
					});
					
					// Show success message
					alert(`"${movieTitle}" added to favorites!`);
				} else {
					// Remove from favorites
					favorites.splice(index, 1);
					
					// Show removed message
					alert(`"${movieTitle}" removed from favorites!`);
				}
				
				// Save to localStorage
				localStorage.setItem('movieFavorites', JSON.stringify(favorites));
				
				// Update UI
				updateFavoritesUI();
			});
			
			// Function to update the UI based on favorites
			function updateFavoritesUI() {
				$('.home__add, .card__add').each(function() {
					const movieId = $(this).data('movie-id');
					const isFavorite = favorites.some(m => m.id === movieId);
					
					if (isFavorite) {
						$(this).html('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>');
						$(this).addClass('active');
					} else {
						$(this).html('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"/></svg>');
						$(this).removeClass('active');
					}
				});
			}
		});
	</script>

	<!-- Live Search Script -->
	<script>
		$(document).ready(function() {
			let searchTimer;
			const searchInput = $('#movie-search-input');
			const searchResultsDropdown = $('.search-results-dropdown');
			const searchResultsList = $('.search-results-list');
			
			// Handle input in search box
			searchInput.on('input', function() {
				const query = $(this).val().trim();
				
				// Clear previous timer
				clearTimeout(searchTimer);
				
				// Hide dropdown if query is empty
				if (query === '') {
					searchResultsDropdown.hide();
					return;
				}
				
				// Set a timer to avoid making requests on every keystroke
				searchTimer = setTimeout(function() {
					// Show loading indicator
					searchResultsList.html('<li style="padding: 15px; text-align: center;">Loading...</li>');
					searchResultsDropdown.show();
					
					// Make AJAX request to search endpoint
					$.ajax({
						url: '/search/',
						data: { query: query },
						type: 'GET',
						dataType: 'json',
						headers: { 'X-Requested-With': 'XMLHttpRequest' },
						success: function(response) {
							// Clear previous results
							searchResultsList.empty();
							
							// If no results, show a message
							if (!response.results || response.results.length === 0) {
								searchResultsList.html('<li style="padding: 15px; text-align: center;">No results found</li>');
								return;
							}
							
							// Show more results (up to 10)
							const results = response.results.slice(0, 10);
							
							// Add results to dropdown
							results.forEach(function(movie) {
								const posterImg = movie.poster_path ? 
									`<img src="${movie.poster_path}" alt="${movie.title}" style="width: 50px; height: 75px; margin-right: 15px; border-radius: 4px;">` : 
									'<div style="width: 50px; height: 75px; background-color: #333; margin-right: 15px; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: #666; font-size: 10px; text-align: center;">No Image</div>';
								
								const year = movie.release_year ? ` (${movie.release_year})` : '';
								const rating = movie.vote_average ? ` - ${movie.vote_average}★` : '';
								const overview = movie.overview ? `<div style="font-size: 0.8em; color: #aaa; margin-top: 5px;">${movie.overview}</div>` : '';
								
								const listItem = `
									<li style="padding: 15px; border-bottom: 1px solid #2b2b2b; display: flex; align-items: center;">
										<a href="{% url 'movie_details' %}?id=${movie.id}" style="display: flex; align-items: center; color: #fff; text-decoration: none; width: 100%;">
											${posterImg}
											<div style="flex: 1;">
												<div style="font-weight: bold; font-size: 1.1em;">${movie.title}${year}</div>
												<div style="font-size: 0.9em; color: #bbb; margin-top: 3px;">${rating}</div>
												${overview}
											</div>
										</a>
									</li>
								`;
								
								searchResultsList.append(listItem);
							});
							
							// Add a "View all results" link at the bottom
							if (response.results.length > 10) {
								const viewAllLink = `
									<li style="padding: 15px; text-align: center; background-color: #1a1a1a;">
										<a href="{% url 'search_movies' %}?query=${encodeURIComponent(query)}" style="color: #ff55a5; text-decoration: none; font-weight: bold;">
											View all ${response.results.length} results
										</a>
									</li>
								`;
								searchResultsList.append(viewAllLink);
							}
						},
						error: function(error) {
							console.error('Search error:', error);
							searchResultsList.html('<li style="padding: 15px; text-align: center;">Error loading results</li>');
							searchResultsDropdown.show(); // Make sure error message is shown
						}
					});
				}, 300); // 300ms delay
			});
			
			// Hide dropdown when clicking outside
			$(document).on('click', function(event) {
				if (!$(event.target).closest('.header__form').length) {
					searchResultsDropdown.hide();
				}
			});
			
			// Show dropdown when focusing on input if there's a value
			searchInput.on('focus', function() {
				if ($(this).val().trim() !== '') {
					$(this).trigger('input');
				}
			});
			
			// Handle mobile responsiveness better
			$(window).on('resize', function() {
				if (searchResultsDropdown.is(':visible')) {
					// Ensure the dropdown width matches the search form
					searchResultsDropdown.css('width', searchInput.closest('.header__form').outerWidth() + 'px');
				}
			});

			// Trigger resize once to set initial width
			$(window).trigger('resize');
		});
	</script>
</body>
</html> 